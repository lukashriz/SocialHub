<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SocialHub | Lukáš Hriž</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Inter Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: {
              50: '#e0f2e9',
              100: '#c8e6d9',
              200: '#a8d8b9',
              300: '#8ac9a0',
              400: '#6ab097',
              500: '#4a9985',
              600: '#3a7d6a',
            }
          },
          borderRadius: {
            '4xl': '2rem'
          }
        }
      }
    }
  </script>

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #f9fbfa 0%, #edf6f2 100%);
      color: #1f2937;
    }

    .glass-card {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(209, 213, 219, 0.6);
      box-shadow: 0 8px 24px -8px rgba(0, 0, 0, 0.06);
      border-radius: 1.75rem;
      padding: 1.5rem;
    }

    .post-card {
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border-radius: 1.5rem;
      overflow: hidden;
    }

    .post-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 30px -10px rgba(74, 153, 133, 0.2);
    }

    .btn-primary {
      background: linear-gradient(135deg, #4a9985, #3a7d6a);
      color: white;
      border-radius: 1rem;
      padding: 0.6rem 1.25rem;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(74, 153, 133, 0.3);
      transition: all 0.25s ease;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(74, 153, 133, 0.4);
    }

    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, #4a9985, #3a7d6a);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      flex-shrink: 0;
    }

    .like-btn.liked {
      color: #ef4444;
    }

    .fade-in {
      animation: fadeIn 0.4s ease forwards;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="min-h-screen py-8">

  <div id="app" class="max-w-2xl mx-auto px-4">
    <!-- Auth Section -->
    <div id="auth-section" class="hidden">
      <div class="glass-card text-center mb-8">
        <h2 id="auth-title" class="text-2xl font-bold mb-6">Login</h2>
        <input id="auth-username" type="text" placeholder="Username" class="w-full p-3 mb-4 rounded-xl border border-gray-300 focus:ring-2 focus:ring-primary-400 outline-none">
        <input id="auth-password" type="password" placeholder="Password" class="w-full p-3 mb-4 rounded-xl border border-gray-300 focus:ring-2 focus:ring-primary-400 outline-none">
        <button id="auth-submit" class="btn-primary w-full py-3">Login</button>
        <p class="mt-4 text-gray-600">
          Don't have an account? 
          <button id="toggle-auth" class="text-primary-600 font-medium">Register</button>
        </p>
      </div>
    </div>

    <!-- Main App (Hidden until logged in) -->
    <div id="main-app" class="hidden">
      <!-- Header -->
      <header class="flex justify-between items-center mb-8">
        <h1 class="text-2xl font-bold">SocialHub</h1>
        <div class="flex items-center gap-4">
          <input id="search-users" type="text" placeholder="Search users..." class="px-4 py-2 rounded-full border border-gray-300 focus:ring-2 focus:ring-primary-400 outline-none w-40">
          <div class="avatar" id="user-avatar">LH</div>
          <button id="logout-btn" class="text-gray-600 hover:text-gray-900">
            <i class="fas fa-sign-out-alt"></i>
          </button>
        </div>
      </header>

      <!-- Create Post -->
      <div class="glass-card mb-8">
        <div class="flex gap-4 mb-4">
          <div class="avatar" id="post-avatar">LH</div>
          <textarea
            id="post-content"
            placeholder="What's on your mind?"
            rows="3"
            class="w-full p-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-primary-400 outline-none resize-none"
          ></textarea>
        </div>
        <div class="flex justify-end">
          <button id="post-btn" class="btn-primary px-6 py-2">Post</button>
        </div>
      </div>

      <!-- Feed -->
      <div id="feed" class="space-y-6"></div>
    </div>
  </div>

  <script>
    // === Data Model ===
    const defaultUsers = [
      { id: 'lukashriz', name: 'Lukáš Hriž', password: 'password', avatar: 'LH', following: ['alexmorgan', 'sarahjdev'] },
      { id: 'alexmorgan', name: 'Alex Morgan', password: 'password', avatar: 'AM', following: ['lukashriz'] },
      { id: 'sarahjdev', name: 'Sarah Johnson', password: 'password', avatar: 'SJ', following: ['lukashriz'] }
    ];

    const defaultPosts = [
      { id: 1, author: 'lukashriz', content: 'Just deployed my new portfolio website! Built with HTML, CSS, Tailwind, and vanilla JavaScript.', timestamp: Date.now() - 7200000, likes: 24, comments: [] },
      { id: 2, author: 'alexmorgan', content: 'Working on a new React project today. Can\'t wait to share it!', timestamp: Date.now() - 14400000, likes: 18, comments: [] },
      { id: 3, author: 'sarahjdev', content: 'Just learned about Tailwind CSS. It\'s amazing how fast you can build responsive designs!', timestamp: Date.now() - 21600000, likes: 32, comments: [] }
    ];

    // === Storage ===
    function loadFromStorage(key, defaultValue) {
      const data = localStorage.getItem(key);
      return data ? JSON.parse(data) : defaultValue;
    }

    function saveToStorage(key, data) {
      localStorage.setItem(key, JSON.stringify(data));
    }

    let users = loadFromStorage('socialhub_users', defaultUsers);
    let posts = loadFromStorage('socialhub_posts', defaultPosts);
    let currentUser = loadFromStorage('socialhub_current_user', null);

    // === Utility ===
    function timeAgo(timestamp) {
      const diff = (Date.now() - timestamp) / 60000; // minutes
      if (diff < 1) return 'Just now';
      if (diff < 60) return `${Math.floor(diff)}m ago`;
      if (diff < 1440) return `${Math.floor(diff / 60)}h ago`;
      return `${Math.floor(diff / 1440)}d ago`;
    }

    function findUser(username) {
      return users.find(u => u.id === username);
    }

    // === Auth ===
    function login(username, password) {
      const user = findUser(username);
      if (user && user.password === password) {
        currentUser = user;
        saveToStorage('socialhub_current_user', currentUser);
        showMainApp();
        return true;
      }
      alert('Invalid username or password');
      return false;
    }

    function register(username, password) {
      if (users.some(u => u.id === username)) {
        alert('Username already exists');
        return false;
      }
      const newUser = {
        id: username,
        name: username,
        password,
        avatar: username.substring(0, 2).toUpperCase(),
        following: []
      };
      users.push(newUser);
      saveToStorage('socialhub_users', users);
      login(username, password);
      return true;
    }

    function logout() {
      currentUser = null;
      saveToStorage('socialhub_current_user', null);
      showAuthSection();
    }

    // === UI ===
    function showAuthSection() {
      document.getElementById('auth-section').classList.remove('hidden');
      document.getElementById('main-app').classList.add('hidden');
    }

    function showMainApp() {
      document.getElementById('auth-section').classList.add('hidden');
      document.getElementById('main-app').classList.remove('hidden');
      document.getElementById('user-avatar').textContent = currentUser.avatar;
      document.getElementById('post-avatar').textContent = currentUser.avatar;
      renderFeed();
    }

    function renderFeed() {
      const feed = document.getElementById('feed');
      feed.innerHTML = '';

      // Get posts from followed users + self
      const followed = [...currentUser.following, currentUser.id];
      const userPosts = posts.filter(p => followed.includes(p.author)).sort((a, b) => b.timestamp - a.timestamp);

      userPosts.forEach(post => {
        const author = findUser(post.author);
        const isLiked = post.likesBy?.includes(currentUser.id) || false;
        const postEl = document.createElement('div');
        postEl.className = 'post-card bg-white p-6 border border-emerald-100 fade-in';
        postEl.innerHTML = `
          <div class="flex gap-4 mb-4">
            <div class="avatar">${author.avatar}</div>
            <div class="flex-1">
              <div class="flex items-center gap-2 mb-1">
                <h3 class="font-bold text-gray-800">${author.name}</h3>
                <span class="text-gray-600 text-sm">@${author.id}</span>
              </div>
              <p class="text-sm text-gray-500">${timeAgo(post.timestamp)}</p>
            </div>
          </div>
          <p class="text-gray-800 mb-4 whitespace-pre-line">${post.content}</p>
          <div class="flex justify-between text-gray-600 mb-4">
            <button class="like-btn flex items-center gap-1 ${isLiked ? 'liked' : ''}" data-id="${post.id}">
              <i class="fas ${isLiked ? 'fa-heart' : 'far fa-heart'}"></i>
              <span>${post.likes || 0}</span>
            </button>
            <button class="comment-btn flex items-center gap-1" data-id="${post.id}">
              <i class="far fa-comment"></i>
              <span>${post.comments.length}</span>
            </button>
          </div>
          <div class="comments space-y-2 mb-4">
            ${post.comments.map(c => {
              const commenter = findUser(c.author);
              return `<div class="text-sm"><span class="font-medium">${commenter.name}:</span> ${c.text}</div>`;
            }).join('')}
          </div>
          <div class="comment-input hidden">
            <div class="flex gap-3">
              <div class="avatar">${currentUser.avatar}</div>
              <input 
                type="text" 
                placeholder="Write a comment..." 
                class="flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-400"
                data-post-id="${post.id}"
              >
            </div>
          </div>
        `;
        feed.appendChild(postEl);
      });

      // Attach event listeners
      document.querySelectorAll('.like-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const id = parseInt(e.currentTarget.dataset.id);
          toggleLike(id);
        });
      });

      document.querySelectorAll('.comment-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const id = parseInt(e.currentTarget.dataset.id);
          const input = document.querySelector(`input[data-post-id="${id}"]`).closest('.comment-input');
          input.classList.toggle('hidden');
          if (!input.classList.contains('hidden')) input.querySelector('input').focus();
        });
      });

      document.querySelectorAll('.comment-input input').forEach(input => {
        input.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            const id = parseInt(e.target.dataset.postId);
            addComment(id, e.target.value.trim());
            e.target.value = '';
          }
        });
      });
    }

    // === Actions ===
    function createPost() {
      const content = document.getElementById('post-content').value.trim();
      if (!content) return;
      const newPost = {
        id: Date.now(),
        author: currentUser.id,
        content,
        timestamp: Date.now(),
        likes: 0,
        likesBy: [],
        comments: []
      };
      posts.unshift(newPost);
      saveToStorage('socialhub_posts', posts);
      document.getElementById('post-content').value = '';
      renderFeed();
    }

    function toggleLike(postId) {
      const post = posts.find(p => p.id === postId);
      if (!post.likesBy) post.likesBy = [];
      const index = post.likesBy.indexOf(currentUser.id);
      if (index === -1) {
        post.likesBy.push(currentUser.id);
        post.likes = post.likesBy.length;
      } else {
        post.likesBy.splice(index, 1);
        post.likes = post.likesBy.length;
      }
      saveToStorage('socialhub_posts', posts);
      renderFeed();
    }

    function addComment(postId, text) {
      if (!text) return;
      const post = posts.find(p => p.id === postId);
      post.comments.push({ author: currentUser.id, text, timestamp: Date.now() });
      saveToStorage('socialhub_posts', posts);
      renderFeed();
    }

    // === Search ===
    function searchUsers(query) {
      if (!query) return [];
      return users.filter(u => 
        u.id.toLowerCase().includes(query.toLowerCase()) || 
        u.name.toLowerCase().includes(query.toLowerCase())
      ).filter(u => u.id !== currentUser.id);
    }

    // === Init ===
    document.addEventListener('DOMContentLoaded', () => {
      // Auth form
      let isRegisterMode = false;
      const authTitle = document.getElementById('auth-title');
      const authSubmit = document.getElementById('auth-submit');
      const toggleAuth = document.getElementById('toggle-auth');

      toggleAuth.addEventListener('click', () => {
        isRegisterMode = !isRegisterMode;
        authTitle.textContent = isRegisterMode ? 'Register' : 'Login';
        authSubmit.textContent = isRegisterMode ? 'Register' : 'Login';
      });

      authSubmit.addEventListener('click', () => {
        const username = document.getElementById('auth-username').value.trim();
        const password = document.getElementById('auth-password').value;
        if (!username || !password) {
          alert('Please fill in all fields');
          return;
        }
        if (isRegisterMode) {
          register(username, password);
        } else {
          login(username, password);
        }
      });

      // Main app
      document.getElementById('post-btn').addEventListener('click', createPost);
      document.getElementById('logout-btn').addEventListener('click', logout);

      document.getElementById('search-users').addEventListener('input', (e) => {
        const query = e.target.value;
        const results = searchUsers(query);
        // In a full app, you'd show a dropdown — for now, just log
        console.log('Search results:', results);
      });

      // Auto-login if already logged in
      if (currentUser) {
        showMainApp();
      } else {
        showAuthSection();
      }
    });
  </script>
</body>
</html>
